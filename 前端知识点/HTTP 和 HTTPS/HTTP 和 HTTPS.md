# 什么是http #
设计 http 最初的目的是为了给 web 浏览器和网站服务器之间提供一种发布和接收 html 页面的方法。所以 http 它是 web 浏览器和网站服务器之间互通的一种桥梁。


# 什么是http协议 #
超文本传输协议，它主要用在 web 浏览器和网站服务器之间的信息传递。它是 web 浏览器与网站服务器之间请求和应答的一种标准，也可以说是一种规范。通过这个标准或者规范，可以使浏览器更加高效的运行。它不仅保证计算机正确、快速的传输超文本文档，而且还确定优先传输文档中的哪一个部分，这也是为什么 html 页面的文本要优先于图片、视频、音频等资源的加载。

从1990年开始，http 协议就开始在 www 上广泛运用，是现今在 www 上运用最多的协议，当你上网浏览网页的时候，web 浏览器和网站服务器之间就通过 http 协议在 internet(互联网) 上进行数据的发送和接收，它是一个基于“请求--响应”模式的、无状态的一种网络传输协议，也就是我们通常所说的 request(获取数据) 和 response(返回数据)

![res](https://img-blog.csdn.net/20161206100434669)<br>

http 协议以明文方式发送内容，不提供任何形式的加密处理，如果有攻击者截取了 web 浏览器和服务器之间传输的数据的话，那么攻击者就可以直接读懂里面的信息，因此，http 协议在进行网络传输数据的时候，不适合传输一些敏感信息，比如信用卡号、密码等。这也是别人经常建议你在公共场合要很小心的链接开放 wifi 一样，因为你的信息很有可能被别有用心的人获取并直接利用。所以在公共场合，你与网站服务器之间的链接最好采用 https 协议，因为它是经过加密处理的，即使你和网站服务器之间传输的信息被别人拿到，但他们也读不懂。


# HTTP 的安全问题 #
在 HTTP 协议中有可能存在信息泄漏或身份伪装等安全问题：

1. 通信使用明文，传输信息不经过加密处理，内容可能被窃取
2. 不验证通信方的身份，有可能遭遇伪装
3. 无法证明报文的完整性，报文可能会被篡改


# 什么是 https #
超文本传输安全协议。HTTP 协议传输的数据都是未加密的，也就是明文的，因此使用 HTTP 协议传输隐私信息非常不安全，为了保证这些隐私数据能加密传输，于是网景公司设计了 SSL 协议，主要用于对 HTTP 协议传输的数据进行加密。

对于 HTTP 来说，客户端也好，服务器也好，都是没有办法确认通信双方的，因为很有可能并不是和原本预想的通信方在进行通信。并且还要考虑到接收到的报文在通信途中有可能被篡改（中间人攻击）。

**为了统一解决上述问题，就诞生了 HTTPS：HTTPS = HTTP + SSL加密 + 身份认证 + 报文完整性保护**



# HTTP 和 HTTPS 的基本概念 #
HTTP：它是现今互联网上运用得最广泛的网络传输协议，主要用于客户端和服务器之间进行请求和响应的一种网络协议，它可以是浏览器更加高效的运行。

HTTPS：它可以说是 HTTP 的一种安全模式，它通过 SSL 层加密处理过。


# HTTP 和 HTTPS 的区别主要如下： #

- http 是超文本传输协议，信息是明文传输，https 则是具有安全性的 SSL 加密传输协议
- http 和 https 使用的是完全不同的连接方式，用的端口也不一样，前者是80，后者是443。


# HTTP 的工作原理 #
![res](https://img-blog.csdn.net/20161206100434669)

# HTTPS的工作原理 #
我们都知道HTTPS能够加密信息，以免敏感信息被第三方获取，所以很多银行网站或电子邮箱等等安全级别较高的服务都会采用HTTPS协议。<br>

![ssf](http://www.mahaixiang.cn/uploads/allimg/1507/1-150H120343I41.jpg)<br>

客户端在使用HTTPS方式与Web服务器通信时有以下几个步骤：

1. 客户使用https的URL访问Web服务器，要求与Web服务器建立SSL连接。
2. Web服务器收到客户端请求后，会将网站的证书信息（证书中包含公钥）传送一份给客户端。
3. 客户端的浏览器与Web服务器开始协商SSL连接的安全等级，也就是信息加密的等级。
4. 客户端的浏览器根据双方同意的安全等级，建立会话密钥，然后利用网站的公钥将会话密钥加密，并传送给Web服务器。
5. Web服务器利用自己的私钥解密出会话密钥。然后在把数据经过之前沟通好的安全等级加密后在传输给浏览器。
6. 浏览器拿到数据后，通过之前的公钥去解析出数据。

![sff](https://pic002.cnblogs.com/images/2012/339704/2012071410212142.gif)



----------



# HTTPS的优点 #
尽管HTTPS并非绝对安全，掌握根证书的机构、掌握加密算法的组织同样可以进行中间人形式的攻击，但HTTPS仍是现行架构下最安全的解决方案，主要有以下几个好处：

1. 使用HTTPS协议可认证用户和服务器，确保数据发送到正确的客户机和服务器
2. HTTPS协议是由SSL+HTTP协议构建的可进行加密传输、身份认证的网络协议，要比http协议安全，可防止数据在传输过程中不被窃取、改变，确保数据的完整性
3. HTTPS是现行架构下最安全的解决方案，虽然不是绝对安全，但它大幅增加了中间人攻击的成本（开发者不可能确保自己的应用绝对无法被攻击，但是只要攻击我们的时候，黑客花费的成本远比他可以获取的利益大得多时，就可以大大减少我们的应用被攻击的次数；防御不是绝对的，我们只能想办法让我们的应用更加安全）
4. 谷歌曾在2014年8月份调整搜索引擎算法，并称“比起同等HTTP网站，采用HTTPS加密的网站在搜索结果中的排名将会更高”



# HTTPS的缺点 #
虽然说HTTPS有很大的优势，但其相对来说，还是存在不足之处的：

1. HTTPS协议握手阶段比较费时，会使页面的加载时间延长近50%，增加10%到20%的耗电
2. HTTPS连接缓存不如HTTP高效，会增加数据开销和功耗，甚至已有的安全措施也会因此而受到影响
3. SSL证书需要钱，功能越强大的证书费用越高，个人网站、小网站没有必要一般不会用
4. SSL证书通常需要绑定IP，不能在同一IP上绑定多个域名，IPv4资源不可能支撑这个消耗
5. HTTPS协议的加密范围也比较有限，在黑客攻击、拒绝服务攻击、服务器劫持等方面几乎起不到什么作用。最关键的，SSL证书的信用链体系并不安全，特别是在某些国家可以控制CA根证书的情况下，中间人攻击一样可行


# 浏览器如何判定你是 http 协议还是 https 协议？ #
浏览器默认的端口一直都是80端口，也就是说默认情况下它是走的http协议，那么为了让它通过 https 协议来访网站，服务器实际上做了重定向：

1. 使用http协议并监听80端口，等待浏览器的访问
2. 在监听的80端口上设置url重定向，指向监听端口为443的https协议的网站

因此，即使你输入http://www.baidu.com:80,做了重定向的服务器也会将此url修改为https://www.baidu.com:443。也就是说，实际判断的过程是由服务器来保证的，浏览器的默认端口一直都是80端口。

由于 http 协议实现了一个叫做 HSTS 的机制，所以你多次访问同一个设置了重定向的服务器时，只有第一次需要访问两个服务器地址，从第二次开始往后，就直接跳转到 https 的链接上了。


# https 对 http 的限制 #
现在越来越多的网站开始采用 https 协议，而在 https 协议下，对 http 有两个限制：

1、https 下不能直接拉取 http 的静态资源文件

浏览器默认是不允许在 HTTPS 里面引用 HTTP 资源的，一般都会弹出提示框，用户确认后才会继续加载，用户体验非常差。而且如果在一个 HTTPS 页面里动态的引入 HTTP 资源，比如引入一个 js 文件，会被直接忽略掉。Chrome21 之后，在 SSL 加密层处理后会被默默的屏蔽掉，只留下一句 console 报告。浏览器为了安全，https 下跨协议调用 http 的是不行的，控制台里会有警告。最好的方法是使用 https 的资源。

2、https 下不能调用 http 的异步请求

如果在 https 的页面中使用 http 的 ajax 调用。会提示跨域的报错，很明显有违ip地址、端口、协议的跨域限制。有两种方案：其一试调用 https 的 ajax，既然页面都升级到 https 了那么服务接口升级也是应该的。其二既然跨域了，我们可以考虑 jsonp 的方案，但是 jsonp 发出的是js文件请求。所以同上一个问题 https 中应用静态资源也必须是 https 的。所以即使是jsonp 的方式也要提供 jsonp 接口的服务器支持 https。

不过 a 标签是可以正常使用的，这个是题外话。

**那么前端应该如何应对？**

1、静态文件拉取：

首先要保证在https的页面中拉取http的静态资源。那么静态资源就必须支持 https。这方面就要去抱运维大神们的大腿了，申请证书，配置到需要使用的服务器上（我们应该事先提供会用到哪些静态资源的域名）。

2、服务升级：

同样的拿到证书后，要保证 ajax 的接口支持 https。这样服务端的工作就支持的差不多了。

3、页面引用：

既然我们的静态文件支持了 http 和 https 两种协议。但是静态文件并不知道页面是什么协议。我们应该怎么适应呢？引用资源的url中我们应该使用相对协议，比如：
<pre>
src="http://a.com/static/a.js"
</pre>

应该改为如下：去掉http:

<pre>
src="//a.com/static/a.js"
</pre>

以“//”开头表示相对协议，页面使用的是什么协议，文件请求也自动是什么协议。同样的异步请求也应该这样适应。




















